<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Countdown â€” A Message for My New Friend</title>

  <!-- Google Fonts: script font for the countdown and a clean sans for UI -->
  <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">

  <style>
    :root{
      --glass-bg: rgba(255,255,255,0.08);
      --glass-border: rgba(255,255,255,0.12);
      --accent: rgba(255,255,255,0.95);
      --muted: rgba(255,255,255,0.75);
      --unlock-green: #7be495;
    }

    html,body{
      height:100%;
      margin:0;
      font-family:"Inter", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      color:var(--accent);
    }

    /* full-screen background image with subtle dark overlay for contrast */
    body{
      background: url('bg.jpeg') center/cover no-repeat fixed;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:32px;
      background-color:#111; /* fallback */
    }

    /* soft vignette & overlay */
    .overlay{
      position:fixed;
      inset:0;
      background: linear-gradient(180deg, rgba(0,0,0,0.35), rgba(0,0,0,0.55));
      pointer-events:none;
      mix-blend-mode:multiply;
    }

    .card{
      width:min(920px, 94vw);
      max-width:1000px;
      padding:48px;
      border-radius:18px;
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border:1px solid rgba(255,255,255,0.06);
      box-shadow: 0 10px 40px rgba(2,6,23,0.6);
      backdrop-filter: blur(8px) saturate(120%);
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:20px;
    }

    .title{
      font-size:1rem;
      opacity:0.9;
      letter-spacing:1px;
      text-transform:uppercase;
      font-weight:600;
      color: rgba(255,255,255,0.88);
      margin-bottom:8px;
    }

    /* countdown in script font */
    .countdown{
      font-family: "Great Vibes", cursive;
      font-size: clamp(48px, 10vw, 120px);
      line-height:0.9;
      color: white;
      text-shadow: 0 6px 30px rgba(0,0,0,0.5);
      display:flex;
      gap:18px;
      align-items:center;
      justify-content:center;
    }

    /* small labels (days, hrs) */
    .units{
      display:flex;
      gap:10px;
      align-items:flex-end;
      justify-content:center;
      margin-top:6px;
      flex-wrap:wrap;
    }
    .unit{
      text-align:center;
      font-size:0.9rem;
      color:var(--muted);
      min-width:62px;
    }

    .values{
      display:flex;
      gap:12px;
      align-items:center;
      justify-content:center;
      flex-wrap:wrap;
      margin-top:6px;
    }

    .value-pill{
      background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
      padding:8px 14px;
      border-radius:10px;
      border:1px solid rgba(255,255,255,0.06);
      font-weight:600;
      min-width:72px;
      text-align:center;
      color:var(--accent);
      font-size:1.05rem;
      box-shadow: 0 6px 20px rgba(0,0,0,0.4);
      backdrop-filter: blur(4px);
    }

    /* small explanatory line */
    .small{
      font-size:0.96rem;
      color: rgba(255,255,255,0.87);
      max-width:820px;
      text-align:center;
      opacity:0.95;
    }
    .small .muted{
      color: rgba(255,255,255,0.76);
      font-weight:500;
    }

    /* button */
    .open-btn{
      margin-top:10px;
      padding:12px 22px;
      border-radius:12px;
      border: none;
      cursor: pointer;
      font-weight:700;
      font-size:1rem;
      background: linear-gradient(90deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));
      color: var(--muted);
      letter-spacing:0.6px;
      transition: transform .18s ease, box-shadow .18s ease, background .25s ease;
      box-shadow: 0 6px 20px rgba(0,0,0,0.45);
      display:inline-flex;
      align-items:center;
      gap:10px;
    }
    .open-btn:active{ transform: translateY(1px); }
    .open-btn[disabled]{
      opacity:0.5;
      cursor:not-allowed;
      filter: grayscale(.03);
    }

    /* unlocked appearance */
    .open-btn.unlocked{
      background: linear-gradient(90deg, rgba(123,228,149,0.12), rgba(123,228,149,0.06));
      color: #052a11;
      box-shadow: 0 10px 30px rgba(123,228,149,0.12), 0 2px 0 rgba(0,0,0,0.2) inset;
      transform: translateY(-2px);
      animation: pulse 1600ms infinite;
    }
    @keyframes pulse{
      0%{ box-shadow: 0 8px 26px rgba(123,228,149,0.10); }
      50%{ box-shadow: 0 18px 40px rgba(123,228,149,0.14); transform: translateY(-3px); }
      100%{ box-shadow: 0 8px 26px rgba(123,228,149,0.10); transform: translateY(-2px); }
    }

    /* modal / SPA image viewer */
    .modal{
      position:fixed;
      inset:0;
      display:flex;
      align-items:center;
      justify-content:center;
      background: rgba(6,8,12,0.6);
      z-index:60;
      opacity:0;
      pointer-events:none;
      transition: opacity 260ms ease;
    }
    .modal.open{
      opacity:1;
      pointer-events:auto;
    }

    .modal-content{
      max-width:92vw;
      max-height:92vh;
      border-radius:14px;
      overflow:hidden;
      box-shadow: 0 20px 60px rgba(2,6,23,0.7);
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border:1px solid rgba(255,255,255,0.06);
      position:relative;
    }

    .modal img{
      display:block;
      width:100%;
      height:auto;
      max-height:86vh;
      object-fit:contain;
      background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.01));
    }

    .close{
      position:absolute;
      top:10px;
      right:10px;
      background: rgba(0,0,0,0.45);
      color:white;
      border:none;
      padding:8px 10px;
      border-radius:8px;
      cursor:pointer;
      font-weight:600;
      z-index:70;
      backdrop-filter: blur(6px);
    }

    /* small footer note */
    .note{
      margin-top:6px;
      font-size:0.82rem;
      color: rgba(255,255,255,0.72);
    }

    /* responsive tweaks */
    @media (max-width:560px){
      .card{ padding:20px; border-radius:14px; gap:12px; }
      .title{ font-size:0.85rem; }
      .small{ font-size:0.92rem; }
    }
  </style>
</head>
<body>
  <div class="overlay" aria-hidden="true"></div>

  <main class="card" role="main" aria-labelledby="pageTitle">
    <div class="title" id="pageTitle">A Little Countdown</div>

    <div class="countdown" aria-live="polite" id="countdownDisplay" title="Countdown to 4 November 2025">
      <!-- script-style text rendered by JS into this container -->
      <span id="scriptTime">â€”:â€”:â€”:â€”</span>
    </div>

    <div class="units" aria-hidden="true">
      <div class="unit">Days</div><div class="unit">Hours</div><div class="unit">Minutes</div><div class="unit">Seconds</div>
    </div>

    <div class="values" aria-hidden="true">
      <div class="value-pill" id="days">--</div>
      <div class="value-pill" id="hours">--</div>
      <div class="value-pill" id="minutes">--</div>
      <div class="value-pill" id="seconds">--</div>
    </div>

    <p class="small">
      <span class="muted">Countdown reveals a message for my new friend â€”</span>
      <em> surprise awaits when the clock strikes the date. (I improvised a gentle message inside the letter.)</em>
    </p>

    <button class="open-btn" id="openBtn" disabled aria-disabled="true" title="Unlocks when countdown reaches zero">ðŸ”’ Open Message</button>

    <div class="note">Target: <strong>4 Nov 2025</strong> (local time)</div>
  </main>

  <!-- modal / SPA viewer -->
  <div id="modal" class="modal" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal-content" role="document">
      <button class="close" id="closeBtn" aria-label="Close message">âœ• Close</button>
      <img id="letterImg" src="letter.jpeg" alt="A letter for my new friend â€” opens here" />
    </div>
  </div>

  <script>
    (function(){
      // target date: 4 Nov 2025 at 00:00 local time (start of day)
      const target = new Date(2025, 10, 4, 0, 0, 0); // monthIndex: 10 = November

      const daysEl = document.getElementById('days');
      const hoursEl = document.getElementById('hours');
      const minutesEl = document.getElementById('minutes');
      const secondsEl = document.getElementById('seconds');
      const scriptEl = document.getElementById('scriptTime');
      const openBtn = document.getElementById('openBtn');
      const modal = document.getElementById('modal');
      const closeBtn = document.getElementById('closeBtn');
      const letterImg = document.getElementById('letterImg');

      // Format helper - pad with leading zeros
      function pad(num){
        return String(num).padStart(2, '0');
      }

      // Update UI
      function update(){
        const now = new Date();
        let diff = target - now;

        if (diff <= 0) {
          // unlocked
          daysEl.textContent = '00';
          hoursEl.textContent = '00';
          minutesEl.textContent = '00';
          secondsEl.textContent = '00';
          scriptEl.textContent = "It's time";

          // enable button if not already enabled
          if (openBtn.disabled) {
            openBtn.disabled = false;
            openBtn.removeAttribute('aria-disabled');
            openBtn.classList.add('unlocked');
            openBtn.innerHTML = 'ðŸ”“ Open Message';
            openBtn.setAttribute('aria-label', 'Open the message');
            // visual pulse + focus
            openBtn.focus({preventScroll:true});
          }
          // stop interval if desired (we'll still keep showing unlocked)
          return;
        }

        const sec = Math.floor(diff / 1000);
        const days = Math.floor(sec / (3600*24));
        const hours = Math.floor((sec % (3600*24)) / 3600);
        const minutes = Math.floor((sec % 3600) / 60);
        const seconds = sec % 60;

        daysEl.textContent = pad(days);
        hoursEl.textContent = pad(hours);
        minutesEl.textContent = pad(minutes);
        secondsEl.textContent = pad(seconds);

        // Format the script-style big text nicely
        // Example: "3d 12h 05m 09s" but try to keep it elegant
        const parts = [
          (days > 0) ? days + 'd' : null,
          hours + 'h',
          pad(minutes) + 'm',
          pad(seconds) + 's'
        ].filter(Boolean).join('  ');
        scriptEl.textContent = parts;
      }

      // initial update
      update();
      // update every 1s
      const timer = setInterval(update, 1000);

      // Button open logic: SPA style
      openBtn.addEventListener('click', function(){
        if (openBtn.disabled) return;
        // show modal
        modal.classList.add('open');
        modal.setAttribute('aria-hidden', 'false');
        // try to focus close for accessibility
        closeBtn.focus();
      });

      // close logic
      function closeModal(){
        modal.classList.remove('open');
        modal.setAttribute('aria-hidden', 'true');
        openBtn.focus();
      }

      closeBtn.addEventListener('click', closeModal);

      // close on overlay click (but not when clicking the image)
      modal.addEventListener('click', function(e){
        if (e.target === modal) closeModal();
      });

      // ESC key to close
      document.addEventListener('keydown', function(e){
        if (e.key === 'Escape' && modal.classList.contains('open')){
          closeModal();
        }
      });

      // image load error fallback
      letterImg.addEventListener('error', function(){
        letterImg.alt = 'Could not load letter.jpeg â€” make sure letter.jpeg is placed next to the HTML file.';
        // show a subtle text overlay or set a placeholder background
        const fallback = document.createElement('div');
        fallback.style.minWidth = '360px';
        fallback.style.minHeight = '200px';
        fallback.style.display = 'flex';
        fallback.style.alignItems = 'center';
        fallback.style.justifyContent = 'center';
        fallback.style.color = 'rgba(255,255,255,0.95)';
        fallback.style.padding = '28px';
        fallback.style.fontSize = '1rem';
        fallback.style.background = 'linear-gradient(180deg, rgba(0,0,0,0.4), rgba(0,0,0,0.6))';
        fallback.innerText = 'message image not found\nPlace letter.jpeg alongside this page.';
        const parent = letterImg.parentElement;
        parent.replaceChild(fallback, letterImg);
      });

      // If page is opened after date (already past), ensure button becomes enabled immediately
      // (update function handles that on load, but ensure attribute states are consistent)
      if (new Date() >= target && openBtn.disabled) {
        openBtn.disabled = false;
        openBtn.removeAttribute('aria-disabled');
        openBtn.classList.add('unlocked');
        openBtn.innerHTML = 'ðŸ”“ Open Message';
      }

    })();
  </script>
</body>
</html>
